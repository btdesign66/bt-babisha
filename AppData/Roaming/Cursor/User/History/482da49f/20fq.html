{% extends "base.html" %}

{% block title %}ALGO-WIZ - {{ algorithm_type.title() }} Visualization{% endblock %}

{% block content %}
<div class="visualization-page">
    <h1>{{ algorithm_type.title() }} Algorithm Visualization</h1>
    
    <div class="controls">
        <select id="algorithm-select" class="algorithm-dropdown">
            {% if algorithm_type == 'sort' %}
                <option value="bubble">Bubble Sort</option>
                <option value="quick">Quick Sort</option>
                <option value="merge">Merge Sort</option>
                <option value="selection">Selection Sort</option>
                <option value="insertion">Insertion Sort</option>
                <option value="heap">Heap Sort</option>
            {% elif algorithm_type == 'search' %}
                <option value="binary">Binary Search</option>
                <option value="linear">Linear Search</option>
            {% elif algorithm_type == 'path' %}
                <option value="dijkstra">Dijkstra's Algorithm</option>
            {% elif algorithm_type == 'linkedlist' %}
                <option value="insert">Insert Node</option>
                <option value="delete">Delete Node</option>
                <option value="reverse">Reverse List</option>
                <option value="detect_cycle">Detect Cycle</option>
                <option value="merge_sorted">Merge Sorted Lists</option>
            {% endif %}
        </select>

        {% if algorithm_type == 'linkedlist' %}
        <div class="linkedlist-controls">
            <div class="input-group">
                <label for="node-value">Node Value:</label>
                <input type="number" id="node-value" class="node-input" min="1" max="100" placeholder="Enter node value">
            </div>
            <div class="input-group">
                <label for="node-position">Position:</label>
                <input type="number" id="node-position" class="position-input" min="0" placeholder="Enter position (0 for start)">
            </div>
            <div class="operation-buttons">
                <button id="insert-btn" class="btn">Insert Node</button>
                <button id="delete-btn" class="btn">Delete Node</button>
                <button id="reverse-btn" class="btn">Reverse List</button>
                <button id="detect-cycle-btn" class="btn">Detect Cycle</button>
                <button id="merge-btn" class="btn">Merge Lists</button>
            </div>
            <div class="list-state">
                <h3>Current List State</h3>
                <div id="list-visualization" class="linked-list-container"></div>
            </div>
        </div>
        {% endif %}

        {% if algorithm_type == 'search' %}
        <div class="searching-controls">
            <div class="input-group">
                <label for="search-array">Array (comma-separated):</label>
                <input type="text" id="search-array" placeholder="e.g., 1,2,3,4,5">
            </div>
            <div class="input-group">
                <label for="search-target">Target Number:</label>
                <input type="number" id="search-target" placeholder="Enter number to search">
            </div>
        </div>
        {% endif %}

        {% if algorithm_type == 'path' %}
        <div class="pathfinding-controls">
            <div class="grid-size-controls">
                <label for="grid-rows">Rows:</label>
                <input type="number" id="grid-rows" min="5" max="20" value="10">
                <label for="grid-cols">Columns:</label>
                <input type="number" id="grid-cols" min="5" max="20" value="10">
                <button id="generate-grid">Generate Grid</button>
            </div>
            <div class="start-end-controls">
                <div class="input-group">
                    <label>Start Point:</label>
                    <input type="number" id="start-row" min="0" placeholder="Row">
                    <input type="number" id="start-col" min="0" placeholder="Col">
                </div>
                <div class="input-group">
                    <label>End Point:</label>
                    <input type="number" id="end-row" min="0" placeholder="Row">
                    <input type="number" id="end-col" min="0" placeholder="Col">
                </div>
            </div>
        </div>
        {% endif %}

        {% if algorithm_type == 'sort' %}
        <div class="input-section">
            <div class="input-group">
                <label for="user-input">Enter numbers (comma-separated):</label>
                <input type="text" id="user-input" placeholder="e.g., 5,2,8,1,9">
                <button id="validate-input">Validate Input</button>
            </div>
            <div id="input-feedback" class="feedback-message"></div>
            <div class="input-options">
                <button id="generate-btn">Generate Random Data</button>
                <input type="number" id="array-size" min="5" max="100" value="10" placeholder="Array size">
            </div>
        </div>
        {% endif %}
        
        <div class="execution-controls">
            <button id="start-btn" disabled>Start</button>
            <button id="pause-btn" disabled>Pause</button>
            <button id="step-btn" disabled>Step</button>
            <button id="reset-btn">Reset</button>
            <button id="theory-btn" class="btn-theory">Show Theory</button>
        </div>
        
        <div class="speed-control">
            <label for="speed">Animation Speed:</label>
            <input type="range" id="speed" min="1" max="5" value="3">
            <span id="speed-value">Normal</span>
        </div>
    </div>

    <div class="content-wrapper">
        <div class="visualization-container">
            <div id="visualization"></div>
            <div id="explanation" class="explanation-panel">
                <h3>Algorithm Steps</h3>
                <div id="step-explanation"></div>
            </div>
        </div>

        <div class="theory-panel" id="theory-panel">
            <div class="theory-header">
                <h3>Theoretical Analysis</h3>
                <button class="close-theory">Ã—</button>
            </div>
            <div class="theory-content">
                <div class="theory-section">
                    <h4 id="algorithm-title">Algorithm Overview</h4>
                    <p id="algorithm-description"></p>
                </div>
                
                <div class="theory-section">
                    <h4>Time Complexity</h4>
                    <div class="complexity-grid">
                        <div class="complexity-item">
                            <span class="label">Best Case:</span>
                            <span id="time-best"></span>
                        </div>
                        <div class="complexity-item">
                            <span class="label">Average Case:</span>
                            <span id="time-average"></span>
                        </div>
                        <div class="complexity-item">
                            <span class="label">Worst Case:</span>
                            <span id="time-worst"></span>
                        </div>
                    </div>
                </div>
                
                <div class="theory-section">
                    <h4>Space Complexity</h4>
                    <p id="space-complexity-theory"></p>
                </div>
            </div>
        </div>
    </div>

    <div class="stats-panel">
        <h3>Performance Statistics</h3>
        <div id="stats">
            <div class="stat-item">
                <label>Comparisons:</label>
                <span id="comparison-count">0</span>
            </div>
            <div class="stat-item">
                <label>Swaps:</label>
                <span id="swap-count">0</span>
            </div>
            <div class="stat-item">
                <label>Time Complexity:</label>
                <span id="time-complexity">-</span>
            </div>
            <div class="stat-item">
                <label>Space Complexity:</label>
                <span id="space-complexity">-</span>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_head %}
<style>
    .visualization-page {
        padding: 20px;
        max-width: 1200px;
        margin: 0 auto;
    }

    .controls {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 20px;
    }

    .algorithm-dropdown {
        width: 200px;
        padding: 8px;
        margin-bottom: 15px;
    }

    .input-group {
        margin-bottom: 15px;
    }

    .input-group label {
        display: block;
        margin-bottom: 5px;
    }

    .input-group input {
        padding: 8px;
        border: 1px solid #ddd;
        border-radius: 4px;
        margin-right: 10px;
    }

    .execution-controls {
        display: flex;
        gap: 10px;
        margin: 15px 0;
    }

    .execution-controls button {
        padding: 8px 16px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        background-color: #2196f3;
        color: white;
    }

    .execution-controls button:disabled {
        background-color: #ccc;
        cursor: not-allowed;
    }

    .speed-control {
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .visualization-container {
        display: flex;
        gap: 20px;
        margin-top: 20px;
    }

    #visualization {
        flex: 2;
        min-height: 400px;
        background: #fff;
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 20px;
    }

    .explanation-panel {
        flex: 1;
        background: #f8f9fa;
        padding: 15px;
        border-radius: 8px;
        max-height: 400px;
        overflow-y: auto;
    }

    .theory-panel {
        display: none;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 0 20px rgba(0,0,0,0.2);
        max-width: 800px;
        width: 90%;
        max-height: 80vh;
        overflow-y: auto;
    }

    .theory-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
    }

    .close-theory {
        background: none;
        border: none;
        font-size: 24px;
        cursor: pointer;
    }

    .stats-panel {
        margin-top: 20px;
        background: #f8f9fa;
        padding: 15px;
        border-radius: 8px;
    }

    .stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
    }

    .stat-item {
        display: flex;
        justify-content: space-between;
        padding: 10px;
        background: white;
        border-radius: 4px;
    }

    /* Pathfinding specific styles */
    .pathfinding-controls {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 8px;
        margin-bottom: 20px;
    }

    .grid-size-controls {
        display: flex;
        gap: 10px;
        align-items: center;
        margin-bottom: 15px;
    }

    .start-end-controls {
        display: flex;
        gap: 20px;
    }

    /* Searching specific styles */
    .searching-controls {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 8px;
        margin-bottom: 20px;
    }

    .searching-controls .input-group {
        margin-bottom: 10px;
    }

    /* Linked List Specific Styles */
    .linkedlist-controls {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 8px;
        margin-bottom: 20px;
    }

    .node-input, .position-input {
        width: 120px;
        padding: 8px;
        border: 1px solid #ddd;
        border-radius: 4px;
        margin-right: 10px;
    }

    .operation-buttons {
        display: flex;
        gap: 10px;
        margin-top: 15px;
        flex-wrap: wrap;
    }

    .operation-buttons button {
        background-color: #2196f3;
        color: white;
        border: none;
        padding: 8px 16px;
        border-radius: 4px;
        cursor: pointer;
        transition: background-color 0.2s;
    }

    .operation-buttons button:hover {
        background-color: #1976d2;
    }

    .linked-list-container {
        display: flex;
        align-items: center;
        flex-wrap: wrap;
        gap: 10px;
        margin-top: 20px;
        padding: 20px;
        background: white;
        border-radius: 8px;
        min-height: 100px;
    }

    .node {
        display: flex;
        align-items: center;
        background: #e3f2fd;
        border: 2px solid #90caf9;
        border-radius: 4px;
        padding: 10px 15px;
        position: relative;
    }

    .node-value {
        font-weight: bold;
        color: #1976d2;
    }

    .node-pointer {
        width: 30px;
        height: 2px;
        background: #666;
        position: relative;
    }

    .node-pointer::after {
        content: '';
        position: absolute;
        right: 0;
        top: -4px;
        border-left: 8px solid #666;
        border-top: 5px solid transparent;
        border-bottom: 5px solid transparent;
    }

    .node.highlighted {
        background: #fff8e1;
        border-color: #ffd740;
    }

    .node.selected {
        background: #ffebee;
        border-color: #ef5350;
    }

    .node.visited {
        background: #e8f5e9;
        border-color: #66bb6a;
    }

    .list-state {
        margin-top: 20px;
    }

    .list-state h3 {
        margin-bottom: 10px;
        color: #333;
    }
</style>
{% endblock %}

{% block extra_scripts %}
<script src="{{ url_for('static', filename='js/d3.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/visualization.js') }}"></script>
{% if algorithm_type == 'sort' %}
    <script src="{{ url_for('static', filename='js/sorting.js') }}"></script>
{% elif algorithm_type == 'search' %}
    <script src="{{ url_for('static', filename='js/searching.js') }}"></script>
{% elif algorithm_type == 'path' %}
    <script src="{{ url_for('static', filename='js/pathfinding.js') }}"></script>
{% elif algorithm_type == 'linkedlist' %}
    <script src="{{ url_for('static', filename='js/linkedlist.js') }}"></script>
{% endif %}
{% endblock %} 